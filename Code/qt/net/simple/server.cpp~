#include <QtNetwork/QTcpSocket>
#include <QtNetwork/QTcpServer>
#include <iostream>
#include <unistd.h>

int main(int argc, char *argv[])
{
  QHostAddress addr(QHostAddress::LocalHost) ;
  QTcpServer tcpServer;
  QTcpSocket client;
  char _buf[1024];
  
  // bind & listen
  if(!_tcpServer->listen(addr /*QHostAddress::Any*/, 8080)) {
    std::cout << "listen/bind error"<< std::endl;
    exit(0);
  } 

  // accept
  tcpServer->waitForNewConnection(10000);
  client = tcpServer.nextPendingConnection();

  // wait data
  client->waitForReadyRead();
  client->readLine(_buf,sizeof(_buf));
  std::cout << "data read:" << _buf << std::endl;
  
  return 0;
}
